# Server Infrastructure Comparison Report

**Report Date**: 2026-02-12
**Report Type**: Baseline Comparison (Documented Configuration)
**Generated By**: Kilo Code (Server Monitor Mode)

---

## Executive Summary

This report provides a baseline comparison of the three servers in the marketing.tvoje.info infrastructure. Due to limited network access, this comparison is based on documented configurations from the Memory Bank rather than live evidence collection.

### Key Findings

| Aspect              | Status                                |
| ------------------- | ------------------------------------- |
| Overall Consistency | ‚úÖ Consistent                         |
| Operating System    | ‚úÖ All Debian 13                      |
| Security Services   | ‚úÖ UFW active, Fail2ban missing (all) |
| Node.js Version     | ‚úÖ All Node.js 20+                    |
| SSH Hardening       | ‚úÖ Consistent across servers          |
| Unique Services     | ‚ö†Ô∏è Role differentiation present       |

---

## 1. Operating System Comparison

### OS Versions

| Server   | OS     | Version     | Architecture |
| -------- | ------ | ----------- | ------------ |
| Server60 | Debian | 13 (Trixie) | x86_64       |
| Server61 | Debian | 13 (Trixie) | x86_64       |
| Server62 | Debian | 13 (Trixie) | x86_64       |

**Status**: ‚úÖ **IDENTICAL** - All servers running the same OS version

### Analysis

- All servers are running Debian 13 (Trixie), the latest stable Debian release
- Consistent architecture (x86_64) across all servers
- This provides a uniform base for operations and security management

---

## 2. Installed Packages Comparison

### Core Packages

| Package     | Server60 | Server61 | Server62 | Status        |
| ----------- | -------- | -------- | -------- | ------------- |
| PM2         | ‚úÖ       | ‚ùå       | ‚úÖ       | Role-specific |
| Nginx       | ‚úÖ       | ‚úÖ       | ‚úÖ       | IDENTICAL     |
| Docker      | ‚úÖ       | ‚úÖ       | ‚úÖ       | IDENTICAL     |
| Node.js 20+ | ‚úÖ       | ‚ùå       | ‚úÖ       | Role-specific |
| Traefik     | ‚ùå       | ‚úÖ       | ‚ùå       | Role-specific |

### Package Analysis

#### Identical Packages (All Servers)

- **Nginx**: Web server on all three servers
- **Docker**: Container runtime on all three servers
- **UFW**: Firewall active on all servers

#### Role-Specific Packages

- **Server60**: PM2, Node.js 20+ (Infrastructure/VPS role)
- **Server61**: Traefik (Gateway/Traefik role)
- **Server62**: PM2, Node.js 20+ (Production/Web role)

**Status**: ‚úÖ **APPROPRIATE** - Package installation follows role-based design

---

## 3. Running Services Comparison

### Service Matrix

| Service | Server60 | Server61 | Server62 | Notes             |
| ------- | -------- | -------- | -------- | ----------------- |
| PM2     | ‚úÖ       | ‚ùå       | ‚úÖ       | Process manager   |
| Nginx   | ‚úÖ       | ‚úÖ       | ‚úÖ       | Web server        |
| Docker  | ‚úÖ       | ‚úÖ       | ‚úÖ       | Container runtime |
| Traefik | ‚ùå       | ‚úÖ       | ‚ùå       | Reverse proxy     |
| SSH     | ‚úÖ       | ‚úÖ       | ‚úÖ       | Remote access     |

### Service Analysis

**Server60 (Infrastructure/VPS)**:

- Primary: PM2 for process management
- Web: Nginx for reverse proxy
- Container: Docker for isolation

**Server61 (Gateway/Traefik)**:

- Primary: Traefik for gateway/reverse proxy
- Web: Nginx (possibly as backup or specific config)
- Container: Docker for Traefik and related services

**Server62 (Production/Web)**:

- Primary: PM2 for portfolio application
- Web: Nginx for reverse proxy
- Container: Docker for application isolation

**Status**: ‚úÖ **OPTIMIZED** - Services aligned with server roles

---

## 4. Network Configuration Comparison

### IP Addressing

| Server   | Hostname | Internal IP  | Tailscale IP | Purpose        |
| -------- | -------- | ------------ | ------------ | -------------- |
| Server60 | server60 | 192.168.1.60 | 100.91.x.x   | Infrastructure |
| Server61 | server61 | 192.168.1.61 | 100.91.x.x   | Gateway        |
| Server62 | server62 | 192.168.1.62 | 100.91.x.x   | Production     |

### SSH Configuration

| Setting              | Server60 | Server61 | Server62 | Status    |
| -------------------- | -------- | -------- | -------- | --------- |
| SSH Port (Internal)  | 2260     | 2261     | 2262     | Unique    |
| SSH Port (Tailscale) | 20       | 20       | 20       | IDENTICAL |
| Root Login           | Disabled | Disabled | Disabled | IDENTICAL |
| Key Auth             | Enabled  | Enabled  | Enabled  | IDENTICAL |

### Port Analysis

| Port | Server60 | Server61 | Server62 | Notes                   |
| ---- | -------- | -------- | -------- | ----------------------- |
| 2260 | ‚úÖ       | ‚ùå       | ‚ùå       | Server60 SSH (internal) |
| 2261 | ‚ùå       | ‚úÖ       | ‚ùå       | Server61 SSH (internal) |
| 2262 | ‚ùå       | ‚ùå       | ‚úÖ       | Server62 SSH (internal) |
| 20   | ‚úÖ       | ‚úÖ       | ‚úÖ       | SSH (Tailscale)         |

**Status**: ‚úÖ **SECURE** - Non-standard SSH ports, consistent security settings

---

## 5. Security Settings Comparison

### Firewall Status (UFW)

| Rule               | Server60 | Server61 | Server62 |
| ------------------ | -------- | -------- | -------- |
| UFW Active         | ‚úÖ       | ‚úÖ       | ‚úÖ       |
| SSH (2260)         | ‚úÖ       | ‚ùå       | ‚ùå       |
| SSH (2261)         | ‚ùå       | ‚úÖ       | ‚ùå       |
| SSH (2262)         | ‚ùå       | ‚ùå       | ‚úÖ       |
| SSH (20/Tailscale) | ‚úÖ       | ‚úÖ       | ‚úÖ       |
| HTTP (80)          | ‚úÖ       | ‚úÖ       | ‚úÖ       |
| HTTPS (443)        | ‚úÖ       | ‚úÖ       | ‚úÖ       |

### Security Analysis

| Security Feature | Status      | Notes                           |
| ---------------- | ----------- | ------------------------------- |
| UFW Active       | ‚úÖ All      | Firewall enabled on all servers |
| SSH Key Auth     | ‚úÖ All      | Key-based authentication        |
| Root Login       | ‚úÖ Disabled | Consistent security             |
| Fail2ban         | ‚ùå All      | NOT INSTALLED (security gap)    |
| iptables         | ‚úÖ All      | Additional layer configured     |

**Security Gaps Identified**:

1. **Fail2ban Not Installed** ‚ö†Ô∏è
   - All three servers are missing Fail2ban
   - This is a critical security gap for SSH brute-force protection
   - Recommendation: Install Fail2ban on all servers

2. **Non-Standard SSH Ports** ‚úÖ (Already Implemented)
   - Good security practice already in place
   - Reduces attack surface from automated scanners

**Status**: ‚úÖ **GOOD** with one critical gap (Fail2ban)

---

## 6. Role Differentiation Analysis

### Server Roles

| Server   | Primary Role       | Unique Services         | Shared Services |
| -------- | ------------------ | ----------------------- | --------------- |
| Server60 | Infrastructure/VPS | PM2, Node.js            | Nginx, Docker   |
| Server61 | Gateway/Traefik    | Traefik                 | Nginx, Docker   |
| Server62 | Production/Web     | PM2, Node.js, Portfolio | Nginx, Docker   |

### Role Assessment

**Server60 - Infrastructure/VPS**:

- ‚úÖ Appropriate for build processes and infrastructure tasks
- ‚úÖ PM2 ready for any Node.js services
- ‚úÖ Docker for containerized tooling

**Server61 - Gateway/Traefik**:

- ‚úÖ Proper role for Traefik reverse proxy
- ‚úÖ Single point of entry for traffic routing
- ‚ö†Ô∏è Ensure Nginx doesn't conflict with Traefik

**Server62 - Production/Web**:

- ‚úÖ Hosts the portfolio application
- ‚úÖ PM2 for application lifecycle management
- ‚úÖ Nginx for serving static content

**Status**: ‚úÖ **WELL-STRUCTURED** - Clear role separation

---

## 7. Configuration Drift Analysis

### Potential Drift Areas

| Configuration    | Drift Risk | Mitigation                   |
| ---------------- | ---------- | ---------------------------- |
| OS Updates       | Medium     | Automated patch management   |
| Package Versions | Medium     | Pin versions in deployment   |
| UFW Rules        | Low        | Document and version control |
| SSH Config       | Low        | Standardized templates       |
| Node.js Version  | Low        | Use .nvmrc                   |

### Drift Detection Strategy

To detect configuration drift:

1. Run evidence collection scripts regularly
2. Compare against this baseline report
3. Alert on significant deviations
4. Automate configuration management (Ansible/Chef/Puppet)

**Status**: üìã **BASELINE ESTABLISHED** - Ready for drift detection

---

## 8. Recommendations

### Immediate Actions

1. **Install Fail2ban** (Critical)

   ```bash
   sudo apt install fail2ban
   sudo systemctl enable fail2ban
   sudo systemctl start fail2ban
   ```

2. **Standardize Monitoring**
   - Deploy same monitoring stack to all servers
   - Configure centralized logging

### Short-Term Actions

1. **Document Nginx Configurations**
   - Compare nginx.conf across servers
   - Ensure consistent security headers

2. **Create SSH Bastion**
   - Consider single entry point via Server61
   - Implement jump host pattern

### Long-Term Actions

1. **Configuration Management**
   - Deploy Ansible/Puppet/Chef
   - Version control all configurations

2. **Container Orchestration**
   - Evaluate Kubernetes vs. Docker Swarm
   - Consider Portainer for GUI management

---

## Appendix A: Evidence Collection Commands

To update this report with live data, execute:

```bash
# Run network debug
bash .kilocode/scripts/server-monitor/debug-network.sh

# Collect evidence from all servers
bash .kilocode/scripts/server-monitor/collect-evidence.sh all

# Generate updated comparison
# (Manual comparison against this baseline)
```

---

## Appendix B: Server Access Matrix

| Server   | Internal IP  | SSH Port | User  | Access Method    |
| -------- | ------------ | -------- | ----- | ---------------- |
| Server60 | 192.168.1.60 | 2260     | admin | Internal Network |
| Server61 | 192.168.1.61 | 2261     | admin | Internal Network |
| Server62 | 192.168.1.62 | 2262     | admin | Internal Network |
| All      | 100.91.x.x   | 20       | admin | Tailscale VPN    |

---

## Appendix C: Related Documentation

| Document              | Location                                               |
| --------------------- | ------------------------------------------------------ |
| Memory Bank - Servers | `.kilocode/rules/memory-bank/servers.md`               |
| Collection Status     | `evidence/collection-status.md`                        |
| Collection Script     | `.kilocode/scripts/server-monitor/collect-evidence.sh` |
| Debug Script          | `.kilocode/scripts/server-monitor/debug-network.sh`    |

---

**Report Version**: 1.0
**Last Updated**: 2026-02-12
**Next Review**: 2026-03-12 (or after significant changes)
